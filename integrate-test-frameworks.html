<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.8.1 from src\site\asciidoc/integrate-test-frameworks.adoc at 2019-05-18
 | Rendered using Apache Maven Fluido Skin 1.7
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20190518" />
    <meta http-equiv="Content-Language" content="en" />
    <title>JDUT:parent &#x2013; </title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.7.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script type="text/javascript" src="./js/apache-maven-fluido-1.7.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/github.min.css" />
			<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
			<script>hljs.initHighlightingOnLoad();</script>
			<style>
				code, pre {
					font-family: "DejaVu Sans Mono","Bitstream Vera Sans Mono",Monaco,Menlo,Consolas,"Courier New",monospace;
					font-size: 14px;
				}
			</style>
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><div id="bannerLeft"><h2>JDUT:parent</h2>
</div>
</div>
        <div class="pull-right"></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
        <li id="projectVersion">Version: 1.0.0-SNAPSHOT<span class="divider">|</span></li>
      <li class=""><a href="index.html" title="Home">Home</a><span class="divider">/</span></li>
    <li class="active "></li>
        <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2019-05-18</li>
      <li class="pull-right"><span class="divider">|</span>
<a href="sitemap.html" title="Site Map">Site Map</a></li>
      <li class="pull-right"><a href="scm.html" title="Source Repository">Source Repository</a></li>
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
    <ul class="nav nav-list">
      <li class="nav-header">Documents</li>
    <li><a href="index.html" title="About"><span class="none"></span>About</a></li>
    <li><a href="guidelines.html" title="Guidelines"><span class="none"></span>Guidelines</a></li>
    <li class="active"><a href="#"><span class="none"></span>Integrate Test Frameworks</a></li>
    <li><a href="examples.html" title="Examples"><span class="none"></span>Examples</a></li>
    <li><a href="yaml-syntax.html" title="YAML Syntax"><span class="none"></span>YAML Syntax</a></li>
      <li class="nav-header">API References</li>
    <li><a href="apidocs/index.html" title="Javadoc"><span class="none"></span>Javadoc</a></li>
    <li><a href="xref/index.html" title="Source Xref"><span class="none"></span>Source Xref</a></li>
      <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a></li>
      <li class="nav-header">Modules</li>
    <li><a href="core/index.html" title="JDUT-core"><span class="none"></span>JDUT-core</a></li>
    <li><a href="testng/index.html" title="JDUT-testng"><span class="none"></span>JDUT-testng</a></li>
    <li><a href="junit4/index.html" title="JDUT-junit4"><span class="none"></span>JDUT-junit4</a></li>
    <li><a href="junit5/index.html" title="JDUT-junit5"><span class="none"></span>JDUT-junit5</a></li>
</ul>
          <hr />
          <div id="poweredBy">
            <div class="clear"></div>
            <div class="clear"></div>
            <div class="clear"></div>
            <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span10" >
<h1>Integrate test frameworks</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#testng">1. TestNG</a>
<ul class="sectlevel2">
<li><a href="#listeners">1.1. Listeners</a></li>
<li><a href="#multiple_listeners">1.2. Multiple listeners</a></li>
<li><a href="#example">1.3. Example</a></li>
</ul>
</li>
<li><a href="#junit_5">2. JUnit 5</a></li>
<li><a href="#junit_4">3. JUnit 4</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This article contains the integration for various test frameworks.</p>
</div>
<div class="paragraph">
<p>For quick example, see <a href="examples.html">Examples</a>.</p>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="testng"><a class="link" href="#testng">1. TestNG</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>You should add dependency of <code>guru.mikelue.jdut:testng</code> before using this module.</p>
</div>
<div class="sect2">
<h3 id="listeners"><a class="link" href="#listeners">1.1. Listeners</a></h3>
<div class="paragraph">
<p>There are three main listeners to be used with</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="apidocs/guru/mikelue/jdut/testng/IInvokedMethodYamlFactoryListener.html">IInvokedMethodYamlFactoryListener</a></dt>
<dd>
<p>Default listener for building/cleaning data per-method</p>
</dd>
<dt class="hdlist1"><a href="apidocs/guru/mikelue/jdut/testng/ISuiteYamlFactoryListener.html">ISuiteYamlFactoryListener</a></dt>
<dd>
<p>Default listener for building/cleaning data per-suite</p>
</dd>
<dt class="hdlist1"><a href="apidocs/guru/mikelue/jdut/testng/ITestContextYamlFactoryListener.html">ITestContextYamlFactoryListener</a></dt>
<dd>
<p>Default listeners for building/clean data per-test</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>You may extend the listeners to customize usage of YAML API</p>
</div>
</div>
<div class="sect2">
<h3 id="multiple_listeners"><a class="link" href="#multiple_listeners">1.2. Multiple listeners</a></h3>
<div class="paragraph">
<p>If you would use multiple listeners for different tests, the <a href="https://testng.org/">TestNG</a> engine <strong>would
executes all of the listeners even if you don&#8217;t annotate the class</strong>.</p>
</div>
<div class="paragraph">
<p>Every listener provided by JDUT has <code>needConductData</code> method to let you write your own logic that is
whether or not to use the listener in certain context.</p>
</div>
</div>
<div class="sect2">
<h3 id="example"><a class="link" href="#example">1.3. Example</a></h3>
<div class="paragraph">
<p>Following example demonstrates the integration with <a href="https://testng.org/">TestNG</a>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="apidocs/guru/mikelue/jdut/annotation/JdutResource.html">@JdutResource</a></dt>
<dd>
<p>you may build your own processor to process the content of JDUT resources.</p>
</dd>
<dt class="hdlist1"><a href="apidocs/guru/mikelue/jdut/testng/TestNGConfig.html">@TestNGConfig</a></dt>
<dd>
<p>defines behaviour of TestNG.</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import guru.mikelue.jdut.annotation.JdutResource;
import guru.mikelue.jdut.testng.IInvokedMethodYamlFactoryListener;
import guru.mikelue.jdut.testng.TestNGConfig;

@Listeners(IInvokedMethodYamlFactoryListener.class)
public class YourTest {
	/**
	 * This method would look for YourTest-do1-yaml in folder idv/you/sample of classpath
	 */
	@Test @JdutResource
	public void do1() {}

	/**
	 * 1. This method would look for YourTest-do2-yaml in folder idv/you/sample of classpath.
	 * 2. The building and cleaning of data would be at first and last testing on the method with data provider, correspondingly.
	 */
	@Test(dataProvider="Do2")
	@JdutResource @TestNGConfig(oneTimeOnly=true)
	public void do2(int value) {}
	private Object[][] getDo2()
	{
		return new Object[][] {
			{ 1 },
			{ 2 },
		};
	}

	/**
	 * Nothing would be built
	 */
	@Test
	public void do3() {}
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="junit_5"><a class="link" href="#junit_5">2. JUnit 5</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>You should add dependency of <code>guru.mikelue.jdut:junit5</code> before using this module.</p>
</div>
<div class="paragraph">
<p><a href="apidocs/guru/mikelue/jdut/junit5/JdutYamlFactory.html">JdutYamlFactory</a> provides out-of-box loading of YAML files by convention.</p>
</div>
<div class="exampleblock">
<div class="title">Example 1. By data source <a href="https://github.com/mikelue/jdata-unit-test/tree/master/junit5/src/test/java/guru/mikelue/jdut/junit5/example/SproutTest.java"><sup>src</sup></a></div>
<div class="content">
<div class="paragraph">
<p>You can use <a href="apidocs/guru/mikelue/jdut/junit5/JdutYamlFactory.html#buildByDataSource(java.util.function.Supplier)">buildByDataSource()</a> to initialize a <a href="apidocs/guru/mikelue/jdut/junit5/JdutYamlFactory.html">JdutYamlFactory</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package guru.mikelue.jdut.junit5.example;
// File: classpath:guru/mikelue/jdut/junit5/example
// 		-&gt; SproutTest.yaml
@TestInstance(PER_CLASS) @JdutResource // <b class="conum">(1)</b>
public class SproutTest {
	public SproutTest() {}

	@RegisterExtension // <b class="conum">(2)</b>
	static JdutYamlFactory myDataSourceFactory = JdutYamlFactory.buildByDataSource(
		DataSourceGetter::get
	);

	// File: classpath:guru/mikelue/jdut/junit5/example
	// 		-&gt; SproutTest-grow.yaml
	@Test @JdutResource // <b class="conum">(3)</b>
	void grow()
	{
		// 1) Execute tested code
		// 2) Assert the result of database
	}
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>loading the data from yaml file: <code>classpath:guru/mikelue/jdut/junit5/example/SproutTest.yaml</code> <a href="https://github.com/mikelue/jdata-unit-test/tree/master/junit5/src/test/resources/guru/mikelue/jdut/junit5/example/SproutTest.yaml"><sup>src</sup></a></p>
</li>
<li>
<p>register factory by data source</p>
</li>
<li>
<p>loading the data from yaml file: <code>classpath:guru/mikelue/jdut/junit5/example/SproutTest-grow.yaml</code> <a href="https://github.com/mikelue/jdata-unit-test/tree/master/junit5/src/test/resources/guru/mikelue/jdut/junit5/example/SproutTest-grow.yaml"><sup>src</sup></a></p>
</li>
</ol>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 2. By customized YamlConductorFactory <a href="https://github.com/mikelue/jdata-unit-test/tree/master/junit5/src/test/java/guru/mikelue/jdut/junit5/example/ChokosTest.java"><sup>src</sup></a></div>
<div class="content">
<div class="paragraph">
<p>You can use <a href="apidocs/guru/mikelue/jdut/junit5/JdutYamlFactory.html#buildByFactory(java.util.function.Supplier)">buildByFactory()</a> to initialize a <a href="apidocs/guru/mikelue/jdut/junit5/JdutYamlFactory.html">JdutYamlFactory</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package guru.mikelue.jdut.junit5.example;
// File: classpath:guru/mikelue/jdut/junit5/example
// 		-&gt; ChokosTest.yaml
@TestInstance(PER_CLASS) @JdutResource // <b class="conum">(1)</b>
public class ChokosTest {
	public ChokosTest() {}

	@RegisterExtension // <b class="conum">(2)</b>
	static JdutYamlFactory myDataSourceFactory = JdutYamlFactory.buildByFactory(
		() -&gt; YamlConductorFactory.build(DataSourceGetter.get())
	);

	// File: classpath:guru/mikelue/jdut/junit5/example
	// 		-&gt; ChokosTest-grow.yaml
	@Test @JdutResource // <b class="conum">(3)</b>
	void grow()
	{
		// 1) Execute tested code
		// 2) Assert the result of database
	}
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>loading the data from yaml file: <code>classpath:guru/mikelue/jdut/junit5/example/ChokosTest.yaml</code> <a href="https://github.com/mikelue/jdata-unit-test/tree/master/junit5/src/test/resources/guru/mikelue/jdut/junit5/example/ChokosTest.yaml"><sup>src</sup></a></p>
</li>
<li>
<p>register factory by data source</p>
</li>
<li>
<p>loading the data from yaml file: <code>classpath:guru/mikelue/jdut/junit5/example/ChokosTest-grow.yaml</code> <a href="https://github.com/mikelue/jdata-unit-test/tree/master/junit5/src/test/resources/guru/mikelue/jdut/junit5/example/ChokosTest-grow.yaml"><sup>src</sup></a></p>
</li>
</ol>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 3. By inheritance and @ExtendWith <a href="https://github.com/mikelue/jdata-unit-test/tree/master/junit5/src/test/java/guru/mikelue/jdut/junit5/example/BroccoliTest.java"><sup>src</sup></a></div>
<div class="content">
<div class="paragraph">
<p>You should extend <a href="apidocs/guru/mikelue/jdut/junit5/JdutYamlFactory.html">JdutYamlFactory</a> and implement <a href="apidocs/guru/mikelue/jdut/junit5/JdutYamlFactory#getYamlConductorFactory.html">getYamlConductorFactory()</a> method.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">class InitYamlFactory extends JdutYamlFactory {
	public InitYamlFactory() {}

	@Override
	public void beforeAll(ExtensionContext context) throws Exception
	{
		// When you override the callback, don't forget to call the parent's implementation
		super.beforeAll(context);
	}

	@Override
	public void afterAll(ExtensionContext context) throws Exception
	{
		// When you override the callback, don't forget to call the parent's implementation
		super.afterAll(context);
	}

	@Override
	protected YamlConductorFactory getYamlConductorFactory(ExtensionContext context, Event event)
	{
		Random r = new Random();
		Supplier&lt;Object&gt; randomSize = () -&gt; r.nextInt(101) + 1;

		// You can customize ConductorConfig
		return YamlConductorFactory.build(
			DataSourceGetter.get(),
			builder -&gt; builder.namedSupplier("random_size", randomSize) // <b class="conum">(1)</b>
		);
	}
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>You can customize data generation by JDUT&#8217;s YAML configuration</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Put the factory in <a href="https://junit.org/junit5/docs/current/api/org/junit/jupiter/api/extension/ExtendWith.html">@ExtendWith</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package guru.mikelue.jdut.junit5.example;
// File: classpath:guru/mikelue/jdut/junit5/example
// 		-&gt; BroccoliTest.yaml
@TestInstance(PER_CLASS) @JdutResource // <b class="conum">(1)</b>
public class BroccoliTest {
	public BroccoliTest() {}

	// 	File: classpath:guru/mikelue/jdut/junit5/example
	// 		-&gt; BroccoliTest-grow.yaml
	@Test @JdutResource // <b class="conum">(2)</b>
	void grow()
	{
		// 1) Execute tested code
		// 2) Assert the result of database
	}
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>loading the data from yaml file: <code>classpath:guru/mikelue/jdut/junit5/example/BroccoliTest.yaml</code> <a href="https://github.com/mikelue/jdata-unit-test/tree/master/junit5/src/test/resources/guru/mikelue/jdut/junit5/example/BroccoliTest.yaml"><sup>src</sup></a></p>
</li>
<li>
<p>loading the data from yaml file: <code>classpath:guru/mikelue/jdut/junit5/example/BroccoliTest-grow.yaml</code> <a href="https://github.com/mikelue/jdata-unit-test/tree/master/junit5/src/test/resources/guru/mikelue/jdut/junit5/example/BroccoliTest-grow.yaml"><sup>src</sup></a></p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="junit_4"><a class="link" href="#junit_4">3. JUnit 4</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>You should add dependency of <code>guru.mikelue.jdut:junit4</code> before using this module.</p>
</div>
<div class="paragraph">
<p>This module supports JUnit4 since version of <strong>4.9</strong>.</p>
</div>
<div class="paragraph">
<p><a href="apidocs/guru/mikelue/jdut/junit4/JdutYamlFactory.html">JdutYamlFactory</a> provides out-of-box loading of YAML files by convention.</p>
</div>
<div class="exampleblock">
<div class="title">Example 1. By @ClassRule <a href="https://github.com/mikelue/jdata-unit-test/tree/master/junit4/src/test/java/guru/mikelue/jdut/junit4/example/PuhaTest.java"><sup>src</sup></a></div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package guru.mikelue.jdut.junit4.example;
// file: classpath:guru/mikelue/jdut/junit4/example
// 		-&gt; PuhaTest.yaml
@JdutResource // <b class="conum">(1)</b>
public class PuhaTest {
	@ClassRule // <b class="conum">(2)</b>
	public static TestRule rule = JdutYamlFactory.buildByDataSource(DataSourceGetter::get);

	public PuhaTest() {}

	@Test
	public void grow()
	{
		// Executes tested code
		// Assertions...
	}
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>loading the data from yaml file: <code>classpath:guru/mikelue/jdut/junit4/example/Test-grow.yaml</code> <a href="https://github.com/mikelue/jdata-unit-test/tree/master/junit4/src/test/resources/guru/mikelue/jdut/junit4/example/PuhaTest.yaml"><sup>src</sup></a></p>
</li>
<li>
<p>put <a href="https://junit.org/junit4/javadoc/latest/org/junit/ClassRule.html">@ClassRule</a> on the <a href="apidocs/guru/mikelue/jdut/junit4/JdutYamlFactory.html">JdutYamlFactory</a> object</p>
</li>
</ol>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 2. By rule of method <a href="https://github.com/mikelue/jdata-unit-test/tree/master/junit4/src/test/java/guru/mikelue/jdut/junit4/example/EggplantTest.java"><sup>src</sup></a></div>
<div class="content">
<div class="paragraph">
<p>The only rule provided by this module is <a href="apidocs/guru/mikelue/jdut/junit4/JdutYamlFactory.html">JdutYamlFactory</a>.</p>
</div>
<div class="paragraph">
<p>You may override <code>buildDuetConductor</code> method to load your own YAML file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package guru.mikelue.jdut.junit4.example;
public class EggplantTest {
	public EggplantTest() {}

	@Rule // <b class="conum">(1)</b>
	public JdutYamlFactory jdutYamlFactoryForMethodLevel = new JdutYamlFactory(DataSourceGetter.get());

	// file: classpath:guru/mikelue/jdut/junit4/example
	// 		-&gt; EggplantTest-grow.yaml
	@Test @JdutResource // <b class="conum">(2)</b>
	public void grow()
	{
		// Executes tested code
		// Assertions...
	}
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>put <a href="https://junit.org/junit4/javadoc/latest/org/junit/Rule.html">@Rule</a> on the <a href="apidocs/guru/mikelue/jdut/junit4/JdutYamlFactory.html">JdutYamlFactory</a> object</p>
</li>
<li>
<p>loading the data from yaml file: <code>classpath:guru/mikelue/jdut/junit4/example/EggplantTest-grow.yaml</code> <a href="https://github.com/mikelue/jdata-unit-test/tree/master/junit4/src/test/resources/guru/mikelue/jdut/junit4/example/EggplantTest-grow.yaml"><sup>src</sup></a></p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Copyright &copy;2019.
All rights reserved.</p>
        </div>
      </div>
    </footer>
  </body>
</html>