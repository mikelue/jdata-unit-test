/**
 * This js is used to compensate the HTML of generated by maven-site-plugin(which uses Doxia) for markdown
 *
 * This js depends on "highligh.js". You should include the prerequisites of the framework.
 * And jQuery, I am using version 2.1.x.
 *
 * You should use following example in markdown to make Doxia working:
 * ```java
 * // hljs:java
 *
 * ... java code ...
 * ```
 *
 * highlight.js - https://highlightjs.org/
 * maven-site-plugin - https://maven.apache.org/plugins/maven-site-plugin/
 * Doxia - https://maven.apache.org/doxia/index.html
 */

$(document).ready(function()
{
    var regExpForHljs = /hljs\s*:\s*(\w+)/;
    $('div.source > pre, pre > code').each(function(index, ele)
    {
        var jqEle = $(ele);

        // Gets the first 32 characters to detect type meta-data
        var headingCharacters = jqEle.text().substr(0, 32);

        var match = regExpForHljs.exec(headingCharacters);

        if (match.length != 2) {
            return;
        }

        var language = match[1];

        switch (jqEle.prop("tagName").toLowerCase()) {
            case "code":
                if (!jqEle.hasClass(language)) {
                    jqEle.addClass(language);
                }
                break;
            case "pre":
                if (!jqEle.hasClass(language)) {
                    jqEle.addClass(language);
                }
                break;
        }

        hljs.highlightBlock(ele);
    });
});
