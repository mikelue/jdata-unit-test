<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.8.1 from src\site\asciidoc/yaml-syntax.adoc at 2019-05-20
 | Rendered using Apache Maven Fluido Skin 1.7
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20190520" />
    <meta http-equiv="Content-Language" content="en" />
    <title>JDUT:parent &#x2013; </title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.7.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script type="text/javascript" src="./js/apache-maven-fluido-1.7.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/github.min.css" />
			<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
			<script>hljs.initHighlightingOnLoad();</script>
			<style>
				code, pre {
					font-family: "DejaVu Sans Mono","Bitstream Vera Sans Mono",Monaco,Menlo,Consolas,"Courier New",monospace;
					font-size: 14px;
				}
			</style>
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><div id="bannerLeft"><h2>JDUT:parent</h2>
</div>
</div>
        <div class="pull-right"></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
        <li id="projectVersion">Version: 1.0.0-SNAPSHOT<span class="divider">|</span></li>
      <li class=""><a href="index.html" title="Home">Home</a><span class="divider">/</span></li>
    <li class="active "></li>
        <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2019-05-20</li>
      <li class="pull-right"><span class="divider">|</span>
<a href="sitemap.html" title="Site Map">Site Map</a></li>
      <li class="pull-right"><a href="scm.html" title="Source Repository">Source Repository</a></li>
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
    <ul class="nav nav-list">
      <li class="nav-header">Documents</li>
    <li><a href="index.html" title="About"><span class="none"></span>About</a></li>
    <li><a href="guidelines.html" title="Guidelines"><span class="none"></span>Guidelines</a></li>
    <li><a href="integrate-test-frameworks.html" title="Integrate Test Frameworks"><span class="none"></span>Integrate Test Frameworks</a></li>
    <li><a href="examples.html" title="Examples"><span class="none"></span>Examples</a></li>
    <li class="active"><a href="#"><span class="none"></span>YAML Syntax</a></li>
      <li class="nav-header">API References</li>
    <li><a href="apidocs/index.html" title="Javadoc"><span class="none"></span>Javadoc</a></li>
    <li><a href="xref/index.html" title="Source Xref"><span class="none"></span>Source Xref</a></li>
      <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a></li>
      <li class="nav-header">Modules</li>
    <li><a href="core/index.html" title="JDUT-core"><span class="none"></span>JDUT-core</a></li>
    <li><a href="testng/index.html" title="JDUT-testng"><span class="none"></span>JDUT-testng</a></li>
    <li><a href="junit4/index.html" title="JDUT-junit4"><span class="none"></span>JDUT-junit4</a></li>
    <li><a href="junit5/index.html" title="JDUT-junit5"><span class="none"></span>JDUT-junit5</a></li>
</ul>
          <hr />
          <div id="poweredBy">
            <div class="clear"></div>
            <div class="clear"></div>
            <div class="clear"></div>
            <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span10" >
<h1>YAML Syntax</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#tags">Tags</a></li>
<li><a href="#structure">Structure</a>
<ul class="sectlevel2">
<li><a href="#defines">defines</a></li>
<li><a href="#config">config</a></li>
<li><a href="#sqltable">!sql!table</a></li>
<li><a href="#jdutsupplier">!jdut!supplier</a></li>
<li><a href="#sqlcode">!sql!code</a></li>
</ul>
</li>
<li><a href="#named_operator">Named Operator</a></li>
<li><a href="#named_decorator">Named Decorator</a></li>
<li><a href="#data_types">Data Types</a></li>
<li><a href="#quick_example">Quick example</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><strong>Why choose YAML as external representation of sample data for testing:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The format could be edit by any of your favor editors.</p>
</li>
<li>
<p>The format could be maintained in <a href="https://en.wikipedia.org/wiki/Version_control">VCS</a>.</p>
</li>
<li>
<p>The <a href="https://yaml.org/spec/1.1/#alias/information%20model">alias</a> of YAML, which benefits editing data of PK and FK on relational-database.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You may reference the <a href="https://github.com/mikelue/jdata-unit-test/tree/master/core/src/test/resources/guru/mikelue/jdut/yaml">sample YAML</a> used in testing code of this framework</p>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="tags"><a class="link" href="#tags">Tags</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Every document should define namespace(tag) of YAML:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">%TAG !jdut! tag:jdut.mikelue.guru:1.0/
%TAG !dbtype! tag:jdut.mikelue.guru:jdbcType:1.8/
%TAG !sql! tag:jdut.mikelue.guru:sql:1.0/

---
= 1st document

---
= 2nd document</code></pre>
</div>
</div>
<div class="paragraph">
<p>By the implementation of <a href="xref/guru/mikelue/jdut/yaml/YamlConductorFactory.html">YamlConductorFactory</a>,
<strong>every document in YAML would be an instance of <a href="apidocs/guru/mikelue/jdut/DuetConductor.html">DuetConductor</a></strong>.</p>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="structure"><a class="link" href="#structure">Structure</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>A document is defined by:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>defines</code>(optional)</dt>
<dd>
<p>You could defines the aliases with this map(the engine would ignore this node).</p>
</dd>
<dt class="hdlist1"><code>config</code>(optional)</dt>
<dd>
<p>Configuration for processing of data defined in this document</p>
</dd>
<dt class="hdlist1"><code>!sql!table! &lt;table_name&gt;</code>(multiple)</dt>
<dd>
<p>Data definitions</p>
<div class="ulist">
<ul>
<li>
<p>For example: <code>!sql!table yp_book</code>, <code>!sql!table yp_vendor</code></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><code>!sql!code</code>(multiple)</dt>
<dd>
<p>Native SQL statement if you like to execute SQL to database directly</p>
</dd>
</dl>
</div>
<div class="sect2">
<h3 id="defines"><a class="link" href="#defines">defines</a></h3>
<div class="paragraph">
<p>In this node, there is nothing to be processed, you may use this node to define alias.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">- defines : [
    &amp;id_1 1,
    &amp;id_2 2
]</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="config"><a class="link" href="#config">config</a></h3>
<div class="paragraph">
<p>The configuration for data processing.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>build_operation</code>(<strong><code>!!str</code></strong>): The operation for building data.</p>
<div class="ulist">
<ul>
<li>
<p>build-in operators: See <a href="guidelines.html">Guidelines</a>(<em>default value</em>: <code>INSERT</code>)</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>clean_operation</code>(<strong><code>!!str</code></strong>): The operation for cleaning data.</p>
<div class="ulist">
<ul>
<li>
<p>value domain: As same as <code>build_operation</code>(<em>default value</em>: <code>DELETE</code>)</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>decorator</code>(<strong><code>!!str</code></strong>) - The name of decorator for every data grain</p>
</li>
<li>
<p><code>transaction</code>(<strong><code>!!bool</code></strong>): Use the transaction function of JDBC for processing data</p>
<div class="ulist">
<ul>
<li>
<p>value domain:</p>
<div class="ulist">
<ul>
<li>
<p><code>true</code> - Use transaction</p>
</li>
<li>
<p><code>false</code>(<em>default value</em>) - Not use transaction</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><code>transaction_isolation</code>(<strong><code>!!str</code></strong>): Set the transaction isolation over JDBC</p>
<div class="ulist">
<ul>
<li>
<p><code>READ_COMMITTED</code>, <code>READ_UNCOMMITTED</code>, <code>REPEATABLE_READ</code>, <code>SERIALIZABLE</code></p>
</li>
<li>
<p><em>default value</em>: as default value of JDBC driver. See <a href="https://docs.oracle.com/javase/8/docs/api/java/sql/Connection.html#getTransactionIsolation--">Connection.getTransactionIsolation</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">- config : {
    build_operation: "REFRESH",
    clean_operation: "DELETE",
    decorator: "decorator_name",
    transaction: false,
    transaction_isolation: "REPEATABLE_READ"
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sqltable"><a class="link" href="#sqltable">!sql!table</a></h3>
<div class="paragraph">
<p>This node represents the data to be update into database.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Override the configuration defined at document-level</p>
</li>
<li>
<p>Set default name of columns</p>
</li>
<li>
<p>Set default usage of key to target row to be updated or deleted</p>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>config</code>(optional)</dt>
<dd>
<p>The configuration section for this table</p>
<div class="ulist">
<ul>
<li>
<p><code>build_operation</code> - The name of operator for building</p>
</li>
<li>
<p><code>clean_operation</code> - The name of operator for cleaning</p>
</li>
<li>
<p><code>decorator</code>: The decorator chains after the global one to decorate this data grain</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1"><code>columns</code>(mandatory if you like to use implicit data row)</dt>
<dd>
<p>The columns for implicit data of row(by <strong><code>!!seq</code></strong>)</p>
</dd>
<dt class="hdlist1"><code>keys</code>(optional)</dt>
<dd>
<p>The explicit definition for key(used by <code>UPDATE</code>, <code>DELETE</code> operator)</p>
</dd>
<dt class="hdlist1"><code>data</code>(mandatory)</dt>
<dd>
<p>The data section for this table, as <strong><code>!!seq</code></strong> of YAML, see simple definition</p>
</dd>
</dl>
</div>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">- !sql!table tab_2 {
  # build/clean name of operation
  config : {
      build_operation: "INSERT",
      clean_operation: "DELETE",
      decorator: "tab_2_decorator"
  },
  # define keys for UPDATE/REFRESH/DELETE
  keys : [ "id_1" ]
  # defines implicit columns
  columns: [ "col_1", "col_2", "col_3", "col_4" ]
  # defines data(implicit or explicit definition are both working)
  data : [
      { col_1: 20, col_2: 40, col_3: "Thing" },
      [ "c1", 20, 40, 50 ]
  ]
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="jdutsupplier"><a class="link" href="#jdutsupplier">!jdut!supplier</a></h3>
<div class="paragraph">
<p>The engine supports the value of column from lambda expression(<a href="https://docs.oracle.com/javase/8/docs/api/java/util/function/Supplier.html">Supplier</a>).</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>!jdata-unit-test:value,1.0:supplier</code>(<code>!jdut!supplier</code>)</dt>
<dd>
<p>The name which is registered with a instance of <a href="https://docs.oracle.com/javase/8/docs/api/java/util/function/Supplier.html">Supplier</a></p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">%TAG !jdut! tag:jdut.mikelue.guru:1.0/
%TAG !dbtype! tag:jdut.mikelue.guru:jdbcType:1.8/
%TAG !sql! tag:jdut.mikelue.guru:sql:1.0/

'''
- !sql!table tab_3 : [
  {
    col_2: !jdut!supplier "value_1",
  }
]</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">YamlConductor.build(
    builder -&gt; builder
        .namedSupplier("value_1", () -&gt; 30);
);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sqlcode"><a class="link" href="#sqlcode">!sql!code</a></h3>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>build_operation</code></dt>
<dd>
<p>The operation while executing <a href="apidocs/guru/mikelue/jdut/DuetConductor.html#build--">DuetConductor.build</a></p>
</dd>
<dt class="hdlist1"><code>clean_operation</code></dt>
<dd>
<p>The operation while executing <a href="apidocs/guru/mikelue/jdut/DuetConductor.html#clean--">DuetConductor.clean</a></p>
</dd>
<dt class="hdlist1"><code>!sql!statement</code></dt>
<dd>
<p>indicates that the text is a SQL statement to be executed by <a href="https://docs.oracle.com/javase/8/docs/api/java/sql/Statement.html#executeUpdate-java.lang.String-">Statement.executeUpdate()</a>.</p>
</dd>
<dt class="hdlist1"><code>!sql!jdbcfunction</code></dt>
<dd>
<p>indicates that the text is the name of a <a href="apidocs/guru/mikelue/jdut/jdbc/JdbcFunction.html">JdbcFunction</a></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong class="green">You don&#8217;t have to provide both of the two operations in <code>!sql!code</code> node</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">- !sql!code
  build_operation: !sql!statement
    INSERT INTO tab_1(col_1, col_2, col_3)
    VALUES(10, '3323', 20)
  clean_operation: !sql!statement
    DELETE tab_1 WHERE col_1 = 10

- !sql!code
  build_operation: !sql!jdbcfunction "func_1"
  clean_operation: !sql!jdbcfunction "func_1"</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">YamlConductor.build(
    builder -&gt; builder
        .namedJdbcFunction(
            "func_1",
            (connection) -&gt; {
                /* Your JDBC operations */
            }
        );
);</code></pre>
</div>
</div>
<hr/>
</div>
</div>
</div>
<div class="sect1">
<h2 id="named_operator"><a class="link" href="#named_operator">Named Operator</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Uses <a href="apidocs/guru/mikelue/jdut/ConductorConfig.Builder.html#namedOperator-java.lang.String-guru.mikelue.jdut.operation.DataGrainOperator-">namedOperator(&#8230;&#8203;)</a> of <a href="apidocs/guru/mikelue/jdut/yaml/YamlConductorFactory.html#build-javax.sql.DataSource-java.util.function.Consumer-">YamlConductorFactory.build(&#8230;&#8203;)</a> to set named <a href="apidocs/guru/mikelue/jdut/decorate/DataGrainDecorator.html">DataGrainDecorator</a>.</p>
</div>
<div class="paragraph">
<p>Also, following methods can override the configurations of factory:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="apidocs/guru/mikelue/jdut/yaml/YamlConductorFactory.html#conductResource-java.lang.String-java.util.function.Consumer-">YamlConductorFactory.conductResource(String, Consumer&lt;ConductorConfig.Builder&gt;)</a></p>
</li>
<li>
<p><a href="apidocs/guru/mikelue/jdut/yaml/YamlConductorFactory.html#conductYaml-java.io.Reader-java.util.function.Consumer-">YamlConductorFactory.conductYaml(String, Consumer&lt;ConductorConfig.Builder&gt;)</a></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">= Document level configuration
- config : {
    build_operation: "insert_and_check"
}

- !sql!table tab_1 {
    config : {
        // Overrides the one assigned in document level
        build_operation: "insert_and_check"
    }
    data : [
        # data ....
    ]
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">YamlConductorFactory.build(
    dataSource,
    builder -&gt; builder
        .namedOperation(
            "insert_and_check",
            (connection, dataRows) -&gt; {
                /* Your JDBC operations */
            }
        );
);</code></pre>
</div>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="named_decorator"><a class="link" href="#named_decorator">Named Decorator</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>You could use <a href="apidocs/guru/mikelue/jdut/ConductorConfig.Builder.html#namedDecorator-java.lang.String-guru.mikelue.jdut.decorate.DataGrainDecorator-">namedDecorator(&#8230;&#8203;)</a> of <a href="apidocs/guru/mikelue/jdut/yaml/YamlConductorFactory.html#build-javax.sql.DataSource-java.util.function.Consumer-">YamlConductorFactory.build(&#8230;&#8203;)</a> to set named <a href="apidocs/guru/mikelue/jdut/decorate/DataGrainDecorator.html">DataGrainDecorator</a>.</p>
</div>
<div class="paragraph">
<p>Also, following methods can override the configurations of factory:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="apidocs/guru/mikelue/jdut/yaml/YamlConductorFactory.html#conductResource-java.lang.String-java.util.function.Consumer-">YamlConductorFactory.conductResource(String, Consumer&lt;ConductorConfig.Builder&gt;)</a></p>
</li>
<li>
<p><a href="apidocs/guru/mikelue/jdut/yaml/YamlConductorFactory.html#conductYaml-java.io.Reader-java.util.function.Consumer-">YamlConductorFactory.conductYaml(String, Consumer&lt;ConductorConfig.Builder&gt;)</a></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">- config : {
    decorator: "coffee_decorate",
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">YamlConductorFactory.build(
    dataSource,
    builder -&gt; builder
        .namedDecorator(
            "value_1",
            (tableDef, data) -&gt; {
                /* Your decoration of data grain */
            }
        );
);</code></pre>
</div>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="data_types"><a class="link" href="#data_types">Data Types</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>See <a href="guidelines.haml">Guidelines</a></p>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="quick_example"><a class="link" href="#quick_example">Quick example</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">%TAG !jdut! tag:jdut.mikelue.guru:1.0/
%TAG !dbtype! tag:jdut.mikelue.guru:jdbcType:1.8/
%TAG !sql! tag:jdut.mikelue.guru:sql:1.0/

---
= Skipped processing for alias usage
- defines : [
    &amp;v1 20,
    &amp;v2 40
]

- config : {
    build_operation: "INSERT",
    clean_operation: "DELETE"
}

- !sql!table tab_1 : [
  { col_1: 10, col_2: "String Value", col_3: !!Timestamp "2010-05-05 10:20:35+08" },
]

- !sql!table tab_2 : {
  columns : [ "col_id", "col_name" ]
  data : [
    [10, "v1"],
    [20, "v2"],
    { col_id: 30, col_name: "new-name"},
  ]
}

- !sql!code
  build_operation: !sql!statement
    INSERT INTO tab_1(col_1, col_2, col_3)
    VALUES(10, '3323', 20)
  clean_operation: !sql!statement
    DELETE tab_1 WHERE col_1 = 10

- !sql!code {
    build_operation: !sql!jdbcfunction "func_1",
    clean_operation: !sql!jdbcfunction "func_2"
}</code></pre>
</div>
</div>
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="references"><a class="link" href="#references">References</a></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://yaml.org/spec/1.1/">YAML 1.1</a></p>
</li>
<li>
<p><a href="https://bitbucket.org/asomov/snakeyaml">SnakeYaml</a></p>
</li>
<li>
<p><a href="https://yaml.org/type/index.html">YAML Tag Repository</a></p>
</li>
</ul>
</div>
</div>
</div>
        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Copyright &copy;2019.
All rights reserved.</p>
        </div>
      </div>
    </footer>
  </body>
</html>